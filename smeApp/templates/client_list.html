{% extends 'dashboard.html' %}
{% load static %}
{% block content %}

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0,user-scalable=0"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" integrity="sha384-O8whS3fhG2OnA5Kas0Y9l3cfpmYjapjI0E4theH4iuMD+pLhbf6JI0jIMfYcK3yZ" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/5.2.3/css/bootstrap.min.css">
  <link rel="stylesheet" href="{% static 'assets/css/styles.css' %}">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/5.2.3/js/bootstrap.min.js"></script>

  <style>
    .mt-4 {
      margin-top: 1.0rem !important;
     }
     .mb-4 {
       margin-bottom: 0.8rem !important;
   }
    .initials-icon {
      display: flex;
      justify-content: center;
      align-items: center;
      width: 40px;
      height: 40px;
      font-size: 32px;
      font-weight: bold;
      color: white;
      border-radius: 50%;
    }

    .modern-button {
      background-image: linear-gradient(90deg, #4C84FF 0%, #B768FF 100%);
      border: none;
      color: white;
      text-align: center;
      text-decoration: none;
      display: inline-block;
      font-size: 14px;
      padding: 8px 16px;
      margin: 4px 2px;
      cursor: pointer;
      border-radius: 25px;
      transition: background-image 0.3s;
    }

    .modern-button:hover {
      background-image: linear-gradient(90deg, #B768FF 0%, #4C84FF 100%);
    }

    @media screen and (max-width: 767px) {
      .modern-button {
        font-size: 12px;
        padding: 8px 16px;
        min-width: 40px;
        font-weight: bold;
      }

      .modern-button.icon-only {
        padding-left: 10px;
        padding-right: 10px;
      }

      .modern-button.icon-only span {
        display: none;
      }
    }
  </style>

</head>
<div class="row gx-6 gy-3 mb-4 align-items-center">
  <div class="col-auto d-none d-sm-block">
    <h2 class="mb-0">Clients<span class="fw-normal text-700 ms-3">({{ clients|length }})</span></h2>
  </div>
  <div class="mb-3">
    <button class="btn btn-primary me-4 modern-button icon-only" type="button" data-bs-toggle="modal" data-bs-target="#addClientModal" aria-haspopup="true" aria-expanded="false" data-bs-reference="parent"><span class="fas fa-plus me-2"></span>Add Client</button>
</div>
</div>
{% include 'client_modal.html' %}
<div class="row justify-content-between align-items-end mb-4 g-3" style="margin-left:-1rem;margin-right:-1rem;">
  <div class="col-12 col-sm-auto">
  </div>
  <div class="col-12 col-sm-auto">
    <div class="d-flex align-items-center">
      <div class="search-box me-3">
          <form class="position-relative" method="GET" data-bs-toggle="search" data-bs-display="static">
              <input class="form-control search-input search" type="search" name="search" placeholder="Search clients" aria-label="Search" />
              <span class="fas fa-search search-box-icon"></span>
          </form>
      </div>
       <a class="btn btn-phoenix-primary px-3 me-1 border-0 text-900 toggle-list-view" href="#" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="List view">
         <span class="fa-solid fa-list fs--2"></span>
       </a>
       <a class="btn btn-phoenix-primary px-3 me-1 toggle-card-view" href="#" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="Card view">
        <svg width="9" height="9" viewbox="0 0 9 9" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M0 0.5C0 0.223857 0.223858 0 0.5 0H1.83333C2.10948 0 2.33333 0.223858 2.33333 0.5V1.83333C2.33333 2.10948 2.10948 2.33333 1.83333 2.33333H0.5C0.223857 2.33333 0 2.10948 0 1.83333V0.5Z" fill="currentColor"></path>
          <path d="M3.33333 0.5C3.33333 0.223857 3.55719 0 3.83333 0H5.16667C5.44281 0 5.66667 0.223858 5.66667 0.5V1.83333C5.66667 2.10948 5.44281 2.33333 5.16667 2.33333H3.83333C3.55719 2.33333 3.33333 2.10948 3.33333 1.83333V0.5Z" fill="currentColor"></path>
          <path d="M6.66667 0.5C6.66667 0.223857 6.89052 0 7.16667 0H8.5C8.77614 0 9 0.223858 9 0.5V1.83333C9 2.10948 8.77614 2.33333 8.5 2.33333H7.16667C6.89052 2.33333 6.66667 2.10948 6.66667 1.83333V0.5Z" fill="currentColor"></path>
          <path d="M0 3.83333C0 3.55719 0.223858 3.33333 0.5 3.33333H1.83333C2.10948 3.33333 2.33333 3.55719 2.33333 3.83333V5.16667C2.33333 5.44281 2.10948 5.66667 1.83333 5.66667H0.5C0.223857 5.66667 0 5.44281 0 5.16667V3.83333Z" fill="currentColor"></path>
          <path d="M3.33333 3.83333C3.33333 3.55719 3.55719 3.33333 3.83333 3.33333H5.16667C5.44281 3.33333 5.66667 3.55719 5.66667 3.83333V5.16667C5.66667 5.44281 5.44281 5.66667 5.16667 5.66667H3.83333C3.55719 5.66667 3.33333 5.44281 3.33333 5.16667V3.83333Z" fill="currentColor"></path>
          <path d="M6.66667 3.83333C6.66667 3.55719 6.89052 3.33333 7.16667 3.33333H8.5C8.77614 3.33333 9 3.55719 9 3.83333V5.16667C9 5.44281 8.77614 5.66667 8.5 5.66667H7.16667C6.89052 5.66667 6.66667 5.44281 6.66667 5.16667V3.83333Z" fill="currentColor"></path>
          <path d="M0 7.16667C0 6.89052 0.223858 6.66667 0.5 6.66667H1.83333C2.10948 6.66667 2.33333 6.89052 2.33333 7.16667V8.5C2.33333 8.77614 2.10948 9 1.83333 9H0.5C0.223857 9 0 8.77614 0 8.5V7.16667Z" fill="currentColor"></path>
          <path d="M3.33333 7.16667C3.33333 6.89052 3.55719 6.66667 3.83333 6.66667H5.16667C5.44281 6.66667 5.66667 6.89052 5.66667 7.16667V8.5C5.66667 8.77614 5.44281 9 5.16667 9H3.83333C3.55719 9 3.33333 8.77614 3.33333 8.5V7.16667Z" fill="currentColor"></path>
          <path d="M6.66667 7.16667C6.66667 6.89052 6.89052 6.66667 7.16667 6.66667H8.5C8.77614 6.66667 9 6.89052 9 7.16667V8.5C9 8.77614 8.77614 9 8.5 9H7.16667C6.89052 9 6.66667 8.77614 6.66667 8.5V7.16667Z" fill="currentColor"></path>
        </svg></a><button class="btn px-3 btn-phoenix-secondary" type="button" data-bs-toggle="modal" data-bs-target="#filterModal" data-boundary="window" aria-haspopup="true" aria-expanded="false" data-bs-reference="parent"><span class="fa-solid fa-filter text-primary" data-fa-transform="down-3"></span></button>
        <div class="modal fade" id="filterModal" tabindex="-1">
      <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content">
              <form id="addEventForm" method="GET" autocomplete="off">
                  <div class="modal-header bg-light py-4">
                      <h5 class="modal-title fw-bold fs-3">Filter</h5>
                      <button class="btn-close" type="button" data-bs-dismiss="modal" aria-label="Close"></button>
                  </div>
                  <div class="modal-body py-4 px-4">
                      <div class="mb-3">
                          <label class="form-label fw-bold mb-2 text-dark" for="createDate">Create Date</label>
                          <div class="input-group custom-input-group">
                              <span class="input-group-text"><i class="fas fa-calendar-alt"></i></span>
                              <select class="form-select" id="createDate" name="create_date">
                                <option value="today" selected="selected">Today</option>
                                <option value="last7Days">Last 7 Days</option>
                                <option value="last30Days">Last 30 Days</option>
                                <option value="last6Months">Last 6 Months</option>
                                <option value="lastYear">Last Year</option>
                                <option value="all">All</option>
                            </select>
                          </div>
                      </div>
                      <div class="mb-3">
                          <label class="form-label fw-bold mb-2 text-dark" for="designation">Client Role</label>
                          <div class="input-group custom-input-group">
                              <span class="input-group-text"><i class="fas fa-user-tag"></i></span>
                              <select class="form-select" id="designation" name="role">
                                  {% for role in role_choices %}
                                  <option value="{{ role.0 }}">{{ role.1 }}</option>
                                  {% endfor %}
                              </select>
                          </div>
                      </div>
                  </div>
                  <div class="modal-footer d-flex justify-content-end align-items-center px-4 pb-4 pt-3">
                      <button class="btn btn-primary px-9 fs--2 my-0" type="submit">Done</button>
                  </div>
              </form>
          </div>
      </div>
  </div>

  </div>
</div>

<div class="card-view">
  <div class="row g-3 list" id="reportsList">
    {% for client in clients %}
<div class="col-12 col-xl-6">
    <div class="card h-100">
        <div class="card-body">
            <div class="border-bottom">
                <div class="d-flex justify-content-between align-items-start">
                    <div class="d-flex align-items-center">
                        <!-- <input class="form-check-input" type="checkbox" /> -->
                        <!-- {% with client.name|first as initial %}
                            <div class="initials-icon" style="background-color: #FFADAD;">
                                {{ initial }}
                            </div>
                        {% endwith %} -->
                        <a style="line-height:1rem;" class="fw-bold fs-1 text-decoration-none title line-clamp-1 me-sm-4" href="{% url 'smeApp:client-detail' client.pk %}">{{ client.name|title|truncatechars:25 }}</a>
                    </div>
                    <div class="dropdown ml-3">
                        <a href="#" role="button" id="clientDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="fas fa-ellipsis-v"></i>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="clientDropdown">
                            <li><a class="dropdown-item" href="{% url 'smeApp:client-detail' client.pk %}">View</a></li>
                            <li><a class="dropdown-item" href="{% url 'smeApp:client-update' client.pk %}">Edit</a></li>
                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item text-danger" href="{% url 'smeApp:client-delete' pk=client.pk %}">Delete</a>                        </ul>
                    </div>
                </div>
                <p class="fs--1 fw-semi-bold text-700 text">{{ client.contact_name }}</p>
            </div>
              <div class="row g-1 g-sm-3 mt-2 lh-2">
                <div class="col-12 col-sm-auto flex-1 mb-0 fs--1 fw-semi-bold text-700"><span class="fa-regular fa-envelope me-2 reportsby"></span>{{ client.email }}</div>
                <div class="col-12 col-sm-auto">
                  <div class="d-flex align-items-center"><span class="me-2 fw-semi-bold text-700" data-feather="grid" style="stroke-width:2;"></span>
                    <p class="mb-0 fs--1 fw-semi-bold text-700 reports">{{ client.role|title }}</p>
                  </div>
                </div>
                <div class="col-12 col-sm-auto">
                  <div class="d-flex align-items-center"><span class="me-2 fw-semi-bold text-700" data-feather="clock" style="stroke-width:2;"></span>
                    <p class="mb-0 fs--1 fw-semi-bold text-700 date">{{client.created_at}}</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        {% empty %}
        <svg width="200px" height="200px" viewBox="0 0 36 36" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--twemoji" preserveAspectRatio="xMidYMid meet" fill="#000000">
        <g id="SVGRepo_bgCarrier" stroke-width="0"/>
        <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"/>
        <g id="SVGRepo_iconCarrier">
        <path fill="#FA743E" d="M27 22H9s-9 0-9 7c0 3.156 4 7 4 7h28s4-3.844 4-7c0-7-9-7-9-7z"/>
        <path fill="#0B0200" d="M21.906 4.262c-2.02-.654-6.772-.475-7.96 1.069c-3.089.059-6.713 2.851-7.188 6.535c-.47 3.645.578 5.338.951 8.079c.422 3.106 2.168 4.099 3.564 4.515C13.281 27.114 15.415 27 19 27c7 0 10.334-4.684 10.629-12.639c.178-4.811-2.645-8.456-7.723-10.099z"/>
        <circle fill="#664131" cx="18" cy="28" r="3"/>
        <path fill="#7C533E" d="M25.89 15.686c-.677-.938-1.545-1.693-3.445-1.96c.713.327 1.396 1.455 1.485 2.079c.089.624.178 1.129-.386.505c-2.261-2.499-4.723-1.515-7.163-3.041c-1.704-1.066-2.223-2.246-2.223-2.246s-.208 1.574-2.792 3.178c-.749.465-1.643 1.5-2.139 3.03c-.357 1.099-.246 2.079-.246 3.754c0 4.889 4.029 9 9 9s9-4.147 9-9c0-3.041-.318-4.23-1.091-5.299zM17 34l-5-1l-2-1H7l-1 4h11c1 0 1-1 1-1c0-.553-1-1-1-1zm9-2l-2 1l-5 1s-1 .447-1 1c0 0 0 1 1 1h11l-1-4h-3z"/>
        <path d="M22 22a1 1 0 0 1-1-1v-1a1 1 0 1 1 2 0v1a1 1 0 0 1-1 1zm-8 0a1 1 0 0 1-1-1v-1a1 1 0 1 1 2 0v1a1 1 0 0 1-1 1z" fill="#000000"/>
        <path fill="#3D2E24" d="M19 26.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 0 1z"/>
        <path d="M5.499 8a.994.994 0 0 1-.599-.2l-4-3a1 1 0 0 1 1.2-1.6l4 3A1 1 0 0 1 5.499 8zm3.002-3a1 1 0 0 1-.833-.445l-2-3A1 1 0 0 1 7.332.445l2 3A1.001 1.001 0 0 1 8.501 5zm22 3a1 1 0 0 1-.601-1.8l4-3a1 1 0 1 1 1.199 1.6l-4 3a.99.99 0 0 1-.598.2zm-3.002-3a1 1 0 0 1-.831-1.555l2-3a1 1 0 1 1 1.664 1.11l-2 3a1 1 0 0 1-.833.445z" fill="#5DADEC"/>
        </g>
        </svg>
        <p style="text-align:center;">It's a bit lonely here, no clients yet!</p>
        {% endfor %}
      </div>
</div>

<div class="list-view">
  <div class="table-responsive scrollbar mx-n1 px-1 border-top">
      <table class="table fs--1 mb-0 leads-table">
        <thead>
      <tr>
          <th class="d-none white-space-nowrap fs--1 align-middle ps-0" style="max-width:20px; width:18px;">
              <div class="form-check mb-0 fs-0">
                  <input class="form-check-input" type="checkbox" data-bulk-select='{"body":"deal-tables-body"}' />
              </div>
          </th>
          <th class="sort white-space-nowrap align-middle text-uppercase" scope="col" data-sort="name" style="width:25%;">Name</th>
          <th class="d-none d-md-table-cell sort align-middle ps-4 pe-5 text-uppercase border-end" scope="col" data-sort="email" style="width:15%;">
              <div class="d-inline-flex flex-center">
                  <div class="d-flex align-items-center px-1 py-1 bg-success-100 rounded me-2"><span class="text-success-600 dark__text-success-300" data-feather="mail"></span></div><span>Email</span>
              </div>
          </th>
          <th class="d-none d-md-table-cell sort align-middle ps-4 pe-5 text-uppercase border-end" scope="col" data-sort="phone" style="width:15%; min-width: 180px;">
              <div class="d-inline-flex flex-center">
                  <div class="d-flex align-items-center px-1 py-1 bg-primary-100 rounded me-2"><span class="text-primary-600 dark__text-primary-300" data-feather="phone"></span></div><span>Phone</span>
              </div>
          </th>
          <th class="d-none d-md-table-cell sort align-middle ps-4 pe-5 text-uppercase border-end" scope="col" data-sort="contact" style="width:15%;">
              <div class="d-inline-flex flex-center">
                  <div class="d-flex align-items-center px-1 py-1 bg-info-100 rounded me-2"><span class="text-info-600 dark__text-info-300" data-feather="user"></span></div><span>Contact name</span>
              </div>
          </th>
          <th class="d-none d-md-table-cell sort align-middle ps-4 pe-5 text-uppercase border-end" scope="col" data-sort="company" style="width:15%;">
              <div class="d-inline-flex flex-center">
                  <div class="d-flex align-items-center px-1 py-1 bg-warning-100 rounded me-2"><span class="text-warning-600 dark__text-warning-300" data-feather="grid"></span></div><span>Company Address</span>
              </div>
          </th>
          <th class="d-none d-md-table-cell sort align-middle ps-4 pe-5 text-uppercase" scope="col" data-sort="date" style="width:15%;">Client Role</th>
          <th class="sort text-end align-middle pe-0 ps-4" scope="col"></th>
      </tr>
      </thead>
          <tbody class="list" id="deal-tables-body">
            {% for client in clients %}
      <tr class="hover-actions-trigger btn-reveal-trigger position-static">
      <td class="d-none fs--1 align-middle">
        <div class="form-check mb-0 fs-0">
          <input class="form-check-input" type="checkbox" />
        </div>
      </td>
      <td class="name align-middle white-space-nowrap">
        <div class="d-flex align-items-center">
          {% with client.name|first as initial %}
            <div class="avatar avatar-xl me-3 initials-icon" style="background-color: #FFADAD;">
              {{ initial }}
            </div>
          {% endwith %}
          <div>
            <a class="fs-0 fw-bold" href="{% url 'smeApp:client-detail' client.pk %}">{{ client.name }}</a>
            <div class="d-flex align-items-center">
              <p class="mb-0 text-1000 fw-semi-bold fs--1 me-2">{{ client.category }}</p>
            </div>
          </div>
        </div>
      </td>
        <td class="d-none d-md-table-cell">{{ client.email }}</td>
        <td class="d-none d-md-table-cell">{{ client.phone }}</td>
        <td class="d-none d-md-table-cell">{{ client.contact_name }}</td>
        <td class="d-none d-md-table-cell">{{client.address}}</td>
        <td class="d-none d-md-table-cell">{{ client.role }}</td>
        <td class="align-middle text-end white-space-nowrap pe-0 action">
             <div class="font-sans-serif btn-reveal-trigger position-static">
               <button class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs--2" type="button" data-bs-toggle="dropdown" data-boundary="window" aria-haspopup="true" aria-expanded="false" data-bs-reference="parent"><span class="fas fa-ellipsis-v fs--2"></span></button>
               <div class="dropdown-menu dropdown-menu-end py-2">
                 <a class="dropdown-item" href="#">View</a>
                 <a class="dropdown-item" href="{% url 'smeApp:client-update' pk=client.pk %}">Edit</a>
                 <div class="dropdown-divider"></div>
                 <a class="dropdown-item text-danger" href="{% url 'smeApp:client-delete' pk=client.pk %}">Delete</a>
               </div>
          </div>
      </td>
    </tr>
    {% empty %}
      <p style="text-align:center;">It's a bit lonely here, no clients yet!</p>
    {% endfor %}
    </tbody>
    </table>
    </div>
      <div class="row align-items-center justify-content-end py-4 pe-0 fs--1">
        <div class="col-auto d-flex">
          <p class="mb-0 d-none d-sm-block me-3 fw-semi-bold text-900" data-list-info="data-list-info"></p><a class="fw-semi-bold" href="#!" data-list-view="*">View all<span class="fas fa-angle-right ms-1" data-fa-transform="down-1"></span></a><a class="fw-semi-bold d-none" href="#!" data-list-view="less">View Less<span class="fas fa-angle-right ms-1" data-fa-transform="down-1"></span></a>
        </div>
        <div class="col-auto d-flex">
          <button class="page-link" data-list-pagination="prev"><span class="fas fa-chevron-left"></span></button>
          <ul class="mb-0 pagination"></ul>
          <button class="page-link pe-0" data-list-pagination="next"><span class="fas fa-chevron-right"></span></button>
        </div>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
    var listView = document.querySelector('.list-view');
    var cardView = document.querySelector('.card-view');
    var toggleListViewButton = document.querySelector('.toggle-list-view');
    var toggleCardViewButton = document.querySelector('.toggle-card-view');

    function showListView() {
      listView.style.display = 'block';
      cardView.style.display = 'none';
    }

    function showCardView() {
      listView.style.display = 'none';
      cardView.style.display = 'block';
    }

    toggleListViewButton.addEventListener('click', function (event) {
      event.preventDefault();
      showListView();
    });

    toggleCardViewButton.addEventListener('click', function (event) {
      event.preventDefault();
      showCardView();
    });
  });
  </script>
{% endblock %}
